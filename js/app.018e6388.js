(function(){"use strict";var a={4395:function(a,n,e){var t=e(9242),o=(e(7658),e(3396)),i=e(4870),r=e(1528),l=e(4311),s=e.p+"img/parking.bd69b7f7.png",c=e.p+"img/self.4188408a.png",p=e.p+"img/beanEater.a89241a8.svg",u=e(5016);const g={class:"container"},f=(0,o._)("div",{id:"map"},null,-1),m={key:0,class:"loading"},v=["src"];var d={__name:"App",setup(a){const n=(0,i.qj)({google:null,map:null,markers:null});let e=(0,i.iH)(""),t=(0,i.qj)([]),d=(0,i.qj)([]),w=(0,i.qj)([]);const b=(0,i.qj)([]),h=(0,i.qj)([]),y=(0,i.qj)([]);let k=(0,i.iH)(!0);(0,o.bv)((async()=>{await C(),await T()}));const S=()=>l.Z.post("https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyCmv7eemUtSQ6T-38_kHyWwhId0Tjm3Q0Q").then((a=>a.data.location)),C=async()=>{let a={};const e=new r.aN({apiKey:"AIzaSyCmv7eemUtSQ6T-38_kHyWwhId0Tjm3Q0Q",version:"weekly",libraries:["places"],language:"zh-TW"});a=await S(),n.google=await e.load(),n.map=new n.google.maps.Map(document.getElementById("map"),{center:a,zoom:15,mapTypeControl:!1,fullscreenControl:!1}),new n.google.maps.Marker({position:a,map:n.map,draggable:!0,icon:{url:c,size:new n.google.maps.Size(60,60),scaledSize:new n.google.maps.Size(50,50)}})},E=(a,n)=>{e.value&&e.value.close(),e.value=n,n.open(map,a)},A=a=>{const e=new n.google.maps.Marker({position:{lat:Number(a.lat),lng:Number(a.lng)},map:n.map,draggable:!1,icon:{url:s,size:new n.google.maps.Size(50,50),scaledSize:new n.google.maps.Size(50,50)},id:a.id}),t=new google.maps.InfoWindow({content:`\n    <p class='textStyle'>位置: ${a.position}</p>\n    <hr />\n    <p class='textStyle'>剩餘車位 : ${a.availableCar}</p>\n    `,position:{lat:Number(a.lat),lng:Number(a.lng)}});e.addListener("click",(function(){E(e,t)}))},O=()=>{t.data.map((a=>{a.ParkingLots.map((a=>{a.AvailableCar=a.AvailableCar<=0?"無車位":a.AvailableCar,b.push({lat:a.Y,lng:a.X,availableCar:a.AvailableCar,id:a.ID,position:a.Position})}))})),d.data.map((a=>{a.car=a.car<=0?"無車位":a.car;let n=a.lnglat.split(",")[1],e=a.lnglat.split(",")[0];h.push({lat:e,lng:n,availableCar:a.car,id:a.id,position:a.address})})),w.data.map((a=>{a.FREESPACE=a.FREESPACE<=0?"無車位":a.FREESPACE,y.push({lat:a.X_COORDINATE,lng:a.Y_COORDINATE,availableCar:a.FREESPACE,id:a.PARKNO,position:a.ADDRESS})})),console.log(y)},j=()=>{b.forEach((a=>{A(a)})),h.forEach((a=>{A(a)})),y.forEach((a=>{A(a)}))},P=async()=>{await C(),await T()};async function T(){try{t=await l.Z.get("https://motoretag.taichung.gov.tw/DataAPI/api/ParkingSpotListAPI")}catch(a){console.log("Taichung err")}try{d=await l.Z.get("/api/parking.php")}catch(a){console.log("Tainan err")}try{w=await l.Z.get("/OpenData/GetParkInfo")}catch(a){console.log("Hsinchu err")}O(),j(),k.value=!1}return(a,n)=>((0,o.wg)(),(0,o.iD)("div",g,[f,(0,o._)("button",{class:"selfbtn",onClick:P},[(0,o.Wm)((0,i.SU)(u.Z))]),(0,i.SU)(k)?((0,o.wg)(),(0,o.iD)("div",m,[(0,o._)("img",{src:(0,i.SU)(p)},null,8,v)])):(0,o.kq)("",!0)]))}};const w=d;var b=w,h=e(65),y=(0,h.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});(0,t.ri)(b).use(y).mount("#app")}},n={};function e(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return a[t](i,i.exports,e),i.exports}e.m=a,function(){var a=[];e.O=function(n,t,o,i){if(!t){var r=1/0;for(p=0;p<a.length;p++){t=a[p][0],o=a[p][1],i=a[p][2];for(var l=!0,s=0;s<t.length;s++)(!1&i||r>=i)&&Object.keys(e.O).every((function(a){return e.O[a](t[s])}))?t.splice(s--,1):(l=!1,i<r&&(r=i));if(l){a.splice(p--,1);var c=o();void 0!==c&&(n=c)}}return n}i=i||0;for(var p=a.length;p>0&&a[p-1][2]>i;p--)a[p]=a[p-1];a[p]=[t,o,i]}}(),function(){e.n=function(a){var n=a&&a.__esModule?function(){return a["default"]}:function(){return a};return e.d(n,{a:n}),n}}(),function(){e.d=function(a,n){for(var t in n)e.o(n,t)&&!e.o(a,t)&&Object.defineProperty(a,t,{enumerable:!0,get:n[t]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()}(),function(){e.o=function(a,n){return Object.prototype.hasOwnProperty.call(a,n)}}(),function(){e.p="/Vue-availableParkingLot/"}(),function(){var a={143:0};e.O.j=function(n){return 0===a[n]};var n=function(n,t){var o,i,r=t[0],l=t[1],s=t[2],c=0;if(r.some((function(n){return 0!==a[n]}))){for(o in l)e.o(l,o)&&(e.m[o]=l[o]);if(s)var p=s(e)}for(n&&n(t);c<r.length;c++)i=r[c],e.o(a,i)&&a[i]&&a[i][0](),a[i]=0;return e.O(p)},t=self["webpackChunkparking"]=self["webpackChunkparking"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=e.O(void 0,[998],(function(){return e(4395)}));t=e.O(t)})();
//# sourceMappingURL=app.018e6388.js.map